# Проект по подсчёту клеток крови

Приложение для анализа изображений крови и подсчёта клеток с использованием различных методов машинного обучения.

## Функциональность

- Загрузка изображений (пользовательский выбор или генерация)
- Применение матричных фильтров
- Три метода подсчёта клеток:
  - Классическое машинное обучение
  - Кластеризация
  - Свёрточная нейронная сеть

## Структура проекта

```
FinalProject/
├── src/
│   ├── gui/                 # Графический интерфейс
│   ├── models/             # Модели ML
│   ├── preprocessing/      # Предобработка изображений
│   └── utils/             # Вспомогательные функции
├── data/                  # Данные для обучения
└── requirements.txt      # Зависимости
```

## Установка

```bash
pip install -r requirements.txt
```

## Запуск

```bash
python src/main.py
```

# Инструкция по использованию проекта

## 1. Генерация датасета

Для генерации синтетического датасета выполните:

```bash
python src/generate_dataset.py
```

В результате будет создана папка `dataset` с поддиректориями `train` и `val`, а также файл конфигурации `dataset.yaml`.

---

## 2. Обучение YOLO

Для обучения модели YOLO на сгенерированном датасете выполните:

```bash
python src/train_yolo.py
```

Модель будет обучена и сохранена в папке `models`.

---

## 3. Массовый эксперимент (оценка моделей на реальных и сгенерированных изображениях)

Для массового прогона всех изображений из папки валидации и генерации новых синтетических изображений с последующим анализом выполните:

```bash
python src/run_experiments.py
```

- Результаты экспериментов сохраняются в локальную базу данных `experiments.db`.
- Для реальных изображений сохраняется путь к файлу, для сгенерированных — число клеток в поле `gen_params`.

---

## 4. Работа с графическим интерфейсом (GUI)

Для запуска графического интерфейса выполните:

```bash
python src/main.py
```

Возможности GUI:
- Загрузка и отображение изображений
- Генерация синтетических изображений
- Применение фильтров (размытие, резкость)
- Анализ изображения с помощью трёх моделей (ML, кластеризация, CNN)
- Просмотр результатов всех экспериментов в виде таблицы (кнопка "Таблица экспериментов")

---

## Примечания
- Для работы необходимы зависимости, указанные в requirements.txt (установите через `pip install -r requirements.txt`).
- Для корректной работы YOLO требуется установленный пакет ultralytics.
- Все пути в скриптах формируются автоматически относительно структуры проекта.

---

Если возникнут вопросы — обращайтесь! 